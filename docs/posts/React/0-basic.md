---
title: ReactåŸºç¡€æ±‡æ€»
date: 2023-01-28 09:32:51
categories: ç»éªŒå¸–
tags:
    - React
---

[ä¸€æ–‡å¸¦ä½ æ¢³ç†Reacté¢è¯•é¢˜ï¼ˆ2023å¹´ç‰ˆæœ¬ï¼‰](https://juejin.cn/post/7182382408807743548#heading-13)

[ğŸ”¥ è¿å…«è‚¡æ–‡éƒ½ä¸æ‡‚è¿˜æŒ‡æœ›åœ¨å‰ç«¯æ··ä¸‹å»ä¹ˆ](https://juejin.cn/post/7016593221815910408#heading-71)


## Reactç‰ˆæœ¬åŒºåˆ«

__React 15__  
ã€stackæ¶æ„ã€‘Stack Reconciler, ä¸å¯ä¸­æ–­ é€’å½’æ›´æ–°  
ã€Reconcileråè°ƒå™¨ã€‘æ¯”è¾ƒæ–°æ—§VDOM, æ‰¾å‡ºå˜åŒ–çš„ç»„ä»¶  
ã€Renderer  æ¸²æŸ“å™¨ã€‘å°†VDOMå˜åŒ–æ¸²æŸ“åˆ°çœŸå®DOM  
ã€è¯„ä»·ã€‘            é˜»å¡ä¸»çº¿ç¨‹ å¡é¡¿ æ— åˆ†ç‰‡ æ— ä¼˜å…ˆçº§è°ƒåº¦

__React 16__  
ã€Fiberæ¶æ„ã€‘Fiber Reconciler, æ¸²æŸ“ä»»åŠ¡æ‹†åˆ†ä¸ºå°å•å…ƒ, æ”¯æŒæš‚åœ, ä¼˜å…ˆçº§è°ƒåº¦  
ã€Schedulerè°ƒåº¦å™¨ã€‘è°ƒåº¦ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œé«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡å…ˆè¿›å…¥ Reconciler  
ã€Hooksã€‘ç”Ÿå‘½å‘¨æœŸã€çŠ¶æ€ç®¡ç†ã€é€»è¾‘å¤ç”¨, è®©å‡½æ•°ç»„ä»¶å¾—ä»¥ç‹¬ç«‹äºç±»ç»„ä»¶  
ã€è¯„ä»·ã€‘æ€§èƒ½æ›´å¥½ ä¸º å¹¶å‘æ¸²æŸ“ å¥ å®šåŸºç¡€

__React 17__  
ã€äº‹ä»¶å§”æ‰˜å˜æ›´ã€‘ä¸å†æŒ‚åœ¨documentä¸Šï¼ŒæŒ‚è½½åœ¨æ ¹DOMå®¹å™¨ä¸­ï¼Œä½¿Reactå¯å¤šç‰ˆæœ¬å¹¶å­˜  
ã€æ–°jsx-runtimeã€‘æ— éœ€å¼•å…¥Reactï¼Œå‡å°åŒ…è£…å°ºå¯¸ï¼Œè€ƒè™‘å¤šç‰ˆæœ¬Reactå…±å­˜çš„æƒ…å†µ  
ã€ç§»é™¤äº‹ä»¶æ± å¤ç”¨æœºåˆ¶ã€‘ç®€åŒ–äº‹ä»¶ç³»ç»Ÿ  
ã€è¯„ä»·ã€‘æä¾› å…¼å®¹æ€§ä¸æ¸è¿›å‡çº§ èƒ½åŠ›ï¼Œä¸º React18å¹¶å‘ é“ºè·¯

__React 18__  
ã€createRootã€‘ReactDOM.render æ”¹å˜ä¸º ReactDOM.createRoot  
ã€è‡ªåŠ¨æ‰¹å¤„ç†ã€‘æ‰€æœ‰ä¸Šä¸‹æ–‡ è‡ªåŠ¨åˆå¹¶åªæ›´æ–°ä¸€æ¬¡, æ— è®ºåŒæ­¥å¼‚æ­¥  
ã€å¹¶å‘æ¸²æŸ“ã€‘  Lane+Scheduler ä¼˜å…ˆçº§è°ƒåº¦  
ã€Laneæ¨¡å‹ã€‘  å–ä»£expirationTimeæ¨¡å‹

## JSXæ˜¯ä»€ä¹ˆ

ã€è¯­æ³•ç³–ã€‘JSXæœ¬è´¨ä¸Šæ˜¯ React.createElement() çš„è¯­æ³•ç³–ã€‚

ã€Babelè§£æã€‘Babelè§£æ æºç  ç”ŸæˆASTï¼Œåå‘è§£æ ç”Ÿæˆ æ‰“åŒ…åçš„æºç 

ã€åªå†™JSã€‘ä¸åŒäºæ¨¡æ¿è¯­æ³• ä¸å¼•å…¥æ–°çš„æ¦‚å¿µå’Œè¯­æ³• åªå†™JS ä¸”æ”¯æŒJSæ‰€æœ‰åŠŸèƒ½

ã€ç»„ä»¶åŒ–ã€‘Reactå›¢é˜Ÿå¸Œæœ› UIä¸é€»è¾‘ç»“åˆ é«˜å†…èšå½¢æˆç»„ä»¶, å¤ç”¨å’Œç»„åˆ

ã€JSä¸HTMLæ ‡ç­¾ç»“åˆã€‘UIä¸é€»è¾‘ä¸æ•°æ® ç»“åˆ é™ä½å¿ƒæ™ºè´Ÿæ‹…

## è™šæ‹ŸDOM

ã€JSå¯¹è±¡ã€‘createElement æ‰§è¡Œè¿”å›çš„ JSå¯¹è±¡, ç”¨äºæè¿°çœŸå®DOM

ã€æ€§èƒ½ å…¼å®¹ã€‘æ‰¹å¤„ç† è‡ªåŠ¨Diffï¼Œè·¨å¹³å°å…¼å®¹ï¼Œè·¨æµè§ˆå™¨å…¼å®¹(äº‹ä»¶ç³»ç»Ÿ)

ã€æ•°æ®é©±åŠ¨è§†å›¾ã€‘å‡å°‘å¿ƒæ™ºè´Ÿæ‹…ï¼Œä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œä»è€Œæå‡å¼€å‘æ•ˆç‡ã€‚

ã€ç¼ºç‚¹ã€‘è™šæ‹ŸDOMå å†…å­˜ï¼Œé¦–å±æ¸²æŸ“ç›¸å¯¹æ…¢ï¼Œéœ€è¦ä»é›¶éå†æ„å»ºç¬¬ä¸€é¢—fiberæ ‘

__è™šæ‹ŸDOMå…·æœ‰å“ªäº›å±æ€§__: key, type, props, children, ref  
propså†…æ‹¿ä¸åˆ° çˆ¶ç»„ä»¶ä¼ é€’çš„ref key, è¢«deleteå¹¶æŒ‚è½½åœ¨äº†vdomä¸Š

__Fiberå…·æœ‰å“ªäº›å±æ€§__  
child sibling updateQueue flags lanes childLanes  
memoizedState memoizedProps alternate

## Diffç®—æ³•(React15)

æ ¹æœ¬ç›®çš„ __å¤ç”¨æ—§çœŸå®dom,å‡å°‘æ¸²æŸ“æ¶ˆè€—__

DiffåŸåˆ™ __åŒå±‚æ¯”è¾ƒ__ __keyæ¯”è¾ƒ__ __typeæ¯”è¾ƒ__

### Reconciliation åè°ƒé˜¶æ®µ
èŠ‚ç‚¹æ¯”è¾ƒ

1. å¦‚æœäºŒè€…typeä¸åŒ, å¸è½½ oldVdom æ•´ä¸ªåˆ†æ”¯, æ ¹æ® æ–°vdom åˆ›å»º æ–°çœŸå®DOMåˆ†æ”¯, å¹¶æ’å…¥ã€‚
2. å¦‚æœäºŒè€…typeç›¸åŒ, å¤ç”¨æ—§Vdom(çœŸå®Dom), `updateElement`æ›´æ–°propsçœŸå®DOM, `updateChildren` Diffå­èŠ‚ç‚¹ã€‚

å­èŠ‚ç‚¹æ¯”è¾ƒ

1. ã€mapã€‘æ—§Vdomç”Ÿæˆmapç»“æ„, keyä¸ºæ—§Vdomçš„key
2. ã€é¡ºåºéå†ã€‘ æ–°Vdom, åŒkeyåŒtype åˆ™å¤ç”¨æ—§Vdom
3. ã€åŒkeyåŒtypeã€‘å‘½ä¸­ä¸”é¡ºåºå¯¹ æ ‡è®° Update, å‘½ä¸­ä½†é¡ºåº ä¸å¯¹æ ‡è®° Move
4. ã€æ’å…¥ç§»åŠ¨åˆ é™¤ã€‘æœªå‘½ä¸­æ–°Vdom Placementæ’å…¥, æœªå‘½ä¸­æ—§Vdom Unmountå¸è½½

### Patché˜¶æ®µ
è¿›è¡ŒDOMæ“ä½œ

1. æœªå‘½ä¸­è€… æ’å…¥ åˆ é™¤
2. å‘½ä¸­è€… è¿›è¡Œmove update(å†…æ–°æ—§vdomå¯¹æ¯”, `updateElement`, é€’å½’`updateChildren`)

> å…¶å®æœ‰ä¸¤è½®éå†, ç¬¬ä¸€è½®åªä¸€å¯¹ä¸€æ¯”è¾ƒ, åº”å¯¹å¤§éƒ¨åˆ†åœºæ™¯, èŠ‚çœæ€§èƒ½  
> å‡½æ•°ç»„ä»¶å’Œç±»ç»„ä»¶æ²¡æœ‰è‡ªå·±çš„çœŸå®DOMï¼Œéœ€è¦é€’å½’è°ƒç”¨findDOMï¼Œæ‹¿åˆ°å­ä»£vdomçš„çœŸå®DOM  
> åˆ¤å®šMove: å‘½ä¸­çš„æ—§VDOMç´¢å¼• æ¯”ä¸Šä¸€ä¸ªä¸éœ€è¦ç§»åŠ¨çš„èŠ‚ç‚¹çš„ç´¢å¼•lastPlacedIndexè¦å°çš„è¯

### ReactDiffçš„åŠ£åŠ¿

åœºæ™¯: [A, B, C, D] -> [D, A, B, C]  
å°¾éƒ¨æ—§vdomåœ¨æ–°vdomé˜Ÿåˆ—å¤´éƒ¨, åˆ™å…¶ä½™æ—§vdomå…¨ä¼šè¢«æ ‡è®°ä¸ºmoveã€‚  
æ­¤æ—¶æ€§èƒ½æœ€å·®ï¼Œvueä¸­å­˜åœ¨åŒç«¯Diff è§£å†³äº†è¿™ä¸ªæç«¯æƒ…å†µã€‚  
Reactå›¢é˜Ÿ å¸Œæœ›ä¿æŒç®—æ³•ç®€å• æç«¯åœºæ™¯è¾ƒå°‘ã€‚

## Diffç®—æ³•(React16)
å…³é”®ç‰¹æ€§: __æ€§èƒ½è¿›ä¸€æ­¥æå‡__ __å¯ä¸­æ–­__  
å…³é”®æœºåˆ¶: åŒFiberæ ‘ Fiberé“¾ EffectList Schedulerè°ƒåº¦  
>æ‰¹é‡æ›´æ–°: åŒFiberæ ‘ EffectList  
>å¯ä¸­æ–­: Fiberé“¾  
>ä¼˜å…ˆçº§ï¼šSchedulerè°ƒåº¦

### Reconciliationåè°ƒ
ä¸React15ç›¸åŒï¼Œä¹Ÿæ˜¯æ–°æ—§Domå¯¹æ¯”:  
ä¸åŒtypeä¸åŒkeyå¸è½½,åŒtypeåŒkey å¤ç”¨å¹¶æ›´æ–°è‡ªå·± å†å­èŠ‚ç‚¹Diff  
`reconcileChildren`é¡ºåºéå† æ–°Vdom, æ ‡è®°æ—§Vdom update move placement unmount

beginWork()  
1.ã€æ–°æ—§Fiberæ ‘ã€‘`current`æ—§Fiberæ ‘ å’Œ `workInProgress`æ–°Fiberæ ‘  
2.ã€Fiberé“¾è¡¨ã€‘å­èŠ‚ç‚¹æ˜¯ Fiberé“¾è¡¨ ä¸æ˜¯æ•°ç»„  
3.ã€Effectã€‘æ¯ä¸ªFiberè®°å½•è‡ªå·±çš„ `effectTag`

### Completeé˜¶æ®µ
completeWork()

1. ã€éå†Fiberé“¾è¡¨ã€‘è‡ªåº•å‘ä¸ŠFiberé“¾è¡¨, éå†Fiberæ ‘ï¼Œæ”¶é›†effectListã€‚
2. ã€EffectListã€‘æ¯ä¸ªFiberæœ‰è‡ªå·±çš„effectListè®°å½• è‡ªå·±åŠå­æ ‘éœ€è¦æ‰§è¡Œçš„DOMæ“ä½œã€‚

### Commité˜¶æ®µ
commitRoot()

1. ã€Fiberæ ‘æ›¿æ¢ã€‘æ‰§è¡ŒeffectListå†…çš„DOMæ“ä½œ, workInProgressæ ‘æ›¿æ¢currentæ ‘ï¼Œå½¢æˆæ–°UIã€‚

https://react.iamkasong.com/diff/multi.html#demo1  
https://www.lumin.tech/blog/react-0-base/  
https://zhuanlan.zhihu.com/p/570962640  
https://qborfy.com/today/20230117.html

### keyçš„ä½œç”¨

æå‡diffé€Ÿåº¦: keyä¸åŒç›´æ¥å¸è½½ï¼Œkeyç›¸åŒï¼Œæ‰è¿›ä¸€æ­¥åˆ¤æ–­typeï¼Œè¿›ä¸€æ­¥updateElement

ç”¨indexä½œä¸ºkey: æ€§èƒ½å·®(keyæ²¡èµ·åˆ°ä½œç”¨), æ—§èŠ‚ç‚¹è¢«é”™è¯¯å¤ç”¨(keyæ²¡å˜)

é™æ€åˆ—è¡¨ æ— åˆ é™¤é‡æ’, çº¯å±•ç¤ºUI, ä»…æœ«å°¾æ–°å¢ å¯ä»¥ä½¿ç”¨indexä½œä¸ºkey




## Fiberæ˜¯ä»€ä¹ˆ

å¯ç®€å•è®¤ä¸ºæ˜¯,ä»¥é“¾è¡¨ç»“æ„ç›¸è¿çš„ è™šæ‹ŸDOMç»“æ„,åŒæ—¶æŒ‚è½½äº† ç»„ä»¶çŠ¶æ€å’Œæ›´æ–°æ“ä½œ ç­‰æ•°æ®

__ä¸€ç§æ¶æ„åç§°__ : React16çš„ReconcileråŸºäºFiberèŠ‚ç‚¹å®ç°ï¼Œè¢«ç§°ä¸ºFiber Reconcilerã€‚

React15çš„Reconcileré‡‡ç”¨é€’å½’çš„æ–¹å¼æ‰§è¡Œï¼Œæ•°æ®ä¿å­˜åœ¨é€’å½’è°ƒç”¨æ ˆä¸­ï¼Œæ‰€ä»¥è¢«ç§°ä¸ºstack Reconcilerã€‚

__ä¸€ç§æ•°æ®ç»“æ„åç§°__ : ä¸€ä¸ªFiberèŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªReact elementï¼Œä¹Ÿå¯¹åº”ä¸€ä¸ªè™šæ‹ŸDOMï¼Œä»¥åŠæ›´å¤šçš„ä¿¡æ¯ï¼Œç»„ä»¶çš„ç±»å‹ï¼Œè™šæ‹ŸDOMã€çœŸå®DOMç­‰ä¿¡æ¯ã€‚

__Reactçš„æœ€å°å·¥ä½œå•å…ƒ__ : è¿è¡Œæ—¶,Fiber å‚¨å­˜äº†è¯¥ç»„ä»¶æ”¹å˜çš„çŠ¶æ€ã€è¦æ‰§è¡Œçš„æ“ä½œï¼ˆåˆ é™¤/æ’å…¥/æ›´æ–°...ï¼‰ã€‚

__æ ¸å¿ƒç†å¿µ__: å¯ä¸­æ–­ å¯æ¢å¤ ä¼˜å…ˆçº§


### ä¸ºä»€ä¹ˆVueä¸éœ€è¦Fiber

è¯¦æƒ…è§ vueæ–‡ä»¶å¤¹ä¸‹çš„ã€ŠReactå’ŒVueçš„åŒºåˆ«ã€‹

### React å’Œ Vue å¯¹æ¯”

è¯¦æƒ…è§ vueæ–‡ä»¶å¤¹ä¸‹çš„ã€ŠReactå’ŒVueçš„åŒºåˆ«ã€‹

[ç å³°](http://zhufengpeixun.com/strong/html/126.11.react-1.html#t112.%E4%B8%BA%E4%BB%80%E4%B9%88%20React%20%E4%BC%9A%E5%BC%95%E5%85%A5%20JSX?)

è™šæ‹Ÿdomæ˜¯ä»€ä¹ˆ? åŸç†? ä¼˜ç¼ºç‚¹?

vue å’Œ react åœ¨è™šæ‹Ÿdomçš„diffä¸Šï¼Œåšäº†å“ªäº›æ”¹è¿›ä½¿å¾—é€Ÿåº¦å¾ˆå¿«?

vue å’Œ react é‡Œçš„keyçš„ä½œç”¨æ˜¯ä»€ä¹ˆ? ä¸ºä»€ä¹ˆä¸èƒ½ç”¨Indexï¼Ÿç”¨äº†ä¼šæ€æ ·? å¦‚æœä¸åŠ keyä¼šæ€æ ·?  
react ä¸ vue æ•°ç»„ä¸­ key çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ  
æå‡diffç®—æ³•çš„åˆ¤æ–­é€Ÿåº¦ï¼Œ  
diffç®—æ³• ä¼šé¦–å…ˆåˆ¤æ–­ æ–°æ—§ key å’Œ å…ƒç´ ç±»å‹ æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´å†å»é€’å½’åˆ¤æ–­å­èŠ‚ç‚¹

React å’Œ Vue çš„æœ¬è´¨åŒºåˆ«:  
Vue æ˜¯é™æ€åˆ†æ template æ–‡ä»¶ï¼Œé‡‡ç”¨é¢„ç¼–è¯‘ä¼˜åŒ–ï¼Œåœ¨è§£ææ¨¡æ¿çš„åŒæ—¶æ„å»º AST ä¾èµ–æ ‘ï¼ŒåŒæ—¶æ ‡è®°å‡ºå¯èƒ½ä¼šå˜åŒ–çš„åŠ¨æ€èŠ‚ç‚¹ã€‚  
åˆ©ç”¨æ•°æ®åŒå‘ç»‘å®šï¼Œè¿›è¡Œæ•°æ®æ‹¦æˆªæˆ–ä»£ç†ï¼Œè¿›è¡Œå“åº”å¼å¤„ç†ã€‚ä»è€Œèƒ½å¤Ÿæ¯”è¾ƒç²¾å‡†çš„è®¡ç®—å‡ºæœ‰æ”¹å˜çš„ DOMï¼Œå‡å°‘è®¡ç®—é‡ã€‚

React æ˜¯å±€éƒ¨æ¸²é‡æ–°æ¸²æŸ“ï¼Œæ ¸å¿ƒå°±æ˜¯ä¸€å †é€’å½’çš„ React.createElement çš„æ‰§è¡Œè°ƒç”¨ã€‚  
å…¶ä¼˜åŒ–çš„æ–¹å‘æ˜¯ä¸æ–­çš„ä¼˜åŒ– React.createElement çš„æ‰§è¡Œé€Ÿåº¦ï¼Œè®©å…¶æ›´å¿«ï¼Œæ›´åˆç†çš„åˆ›å»ºæœ€ç»ˆçš„å…ƒç´ ã€‚



### AOT vs JIT

AOTï¼ŒAhead Of Timeï¼Œæå‰ç¼–è¯‘æˆ–é¢„ç¼–è¯‘ï¼Œå®¿ä¸»ç¯å¢ƒè·å¾—çš„æ˜¯ç¼–è¯‘åçš„ä»£ç ï¼Œåœ¨æµè§ˆå™¨ä¸­æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¸‹è½½å¹¶è¿è¡Œç¼–è¯‘åçš„ä»£ç ï¼Œæ¯”å¦‚ï¼šVueçš„templateæ˜¯é€šè¿‡Vue-loaderç¼–è¯‘åæ‰èƒ½ä½¿ç”¨ã€‚

JITï¼ŒJust In Timeï¼Œå³æ—¶ç¼–è¯‘ ï¼Œä»£ç åœ¨å®¿ä¸»ç¯å¢ƒç¼–è¯‘å¹¶æ‰§è¡Œï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯å•ç‹¬ç¼–è¯‘çš„ï¼Œå½“æˆ‘ä»¬æ›´æ”¹ä»£ç æ—¶ä¸éœ€è¦å†æ¬¡æ„å»ºæ•´ä¸ªé¡¹ç›®ï¼Œæ¯”å¦‚ï¼šReactä¸­JSXåªæœ‰åœ¨æµè§ˆå™¨è¿è¡Œçš„æ—¶å€™æ‰çŸ¥é“å…·ä½“ä»£ç ã€‚



## Hooks(React 16.8)

__ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ¡ä»¶å’Œå¾ªç¯é‡Œä½¿ç”¨Hooks__  
Reactçš„hooksç”¨äºå­˜å‚¨çŠ¶æ€ï¼Œä½†å‡½æ•°æ˜¯æ— æ³•å‚¨å­˜çŠ¶æ€çš„ï¼Œå› ä¸ºæ‰§è¡Œå®Œåå‡½æ•°æ‰§è¡Œæ ˆå°±ä¼šé”€æ¯  
æ‰€ä»¥ï¼Œhooksçš„çŠ¶æ€ä¿å­˜åœ¨å‡½æ•°ç»„ä»¶çš„ è™šæ‹Ÿdomä¸Šï¼Œ  
é‡‡ç”¨çš„æ•°æ®ç»“æ„ä¹Ÿä¸æ˜¯ objectçš„é”®å€¼å¯¹æ¨¡å¼ï¼Œè€Œæ˜¯é“¾è¡¨æ¨¡å¼ã€‚  
æ¯ä¸ªhooksæ‰§è¡Œéƒ½å±äºé“¾è¡¨çš„ä¸€ç¯ï¼Œåˆå§‹åŒ–æ‰§è¡Œæ—¶é¡ºåºå‚¨å­˜æ•°æ®ï¼Œ  
åç»­æ›´æ–°æ—¶ï¼Œé¡ºåºè¯»å–æ•°æ®ï¼Œæ‰€ä»¥é¡ºåºä¸èƒ½è¢«æ‰“ä¹±ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨æ¡ä»¶å’Œå¾ªç¯å†…ä½¿ç”¨ã€‚

__useState å’Œ useReducer çš„åŒºåˆ«__  
useStateç›´æ¥åœ¨fiberä¸­å‚¨å­˜ç”¨æˆ·ä¼ å…¥çš„å€¼  
useReducerå°† ç”¨æˆ·ä¼ å…¥çš„å€¼ ä¼ ç»™reducerå¤„ç†å‡½æ•°æ‰§è¡Œå å‚¨å­˜åœ¨fiberä¸­ã€‚  
useStateï¼Œå†…éƒ¨å…¶å®å°±æ˜¯è°ƒç”¨çš„ useReducerã€‚  
useReducerï¼Œç”¨äºå¤„ç†å¤æ‚çš„æ•°æ®å¤„ç†é€»è¾‘ã€‚

__useMemo å’Œ useCallback çš„åŒºåˆ«__  
æ¥æ”¶åˆ›å»ºå‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoized å€¼ã€‚  
ç”¨äºé¿å…æ¯æ¬¡æ¸²æŸ“éƒ½è¿›è¡Œé«˜å¼€é”€çš„å±æ€§è®¡ç®—  
useCallbackï¼Œä¾èµ–å˜æ›´æ—¶æ‰è¿”å›æ–°å‡½æ•°ï¼Œé€‚ç”¨äºçˆ¶èŠ‚ç‚¹ä¼ é€’å‡½æ•°ç»™å­èŠ‚ç‚¹è°ƒç”¨çš„æƒ…å†µï¼Œå¯ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚

__useEffect å’Œ useLayoutEffect åŒºåˆ«__


__useContextåŸç†__  
useContextæœ¬èº«çš„åŸç†éå¸¸ç®€å•ï¼Œå°±æ˜¯ä»ä¼ å…¥çš„contextå¯¹è±¡ä¸Šè¯»å–äº†ä»–çš„ï¼Œä¸‹åˆ’çº¿currentValueå±æ€§  
ä½¿ç”¨react.createContextçš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€å¯¹è±¡contextï¼Œ  
è¿™ä¸ªå¯¹è±¡æœ‰provider consumer _currentValueå±æ€§  
åœ¨çˆ¶èŠ‚ç‚¹è°ƒç”¨provider ä¼šå¯¹ currentValueè¿›è¡Œèµ‹å€¼ï¼Œåœ¨å­èŠ‚ç‚¹å†ä»currentValueå–å€¼ã€‚

__useRefæ˜¯å•ä¾‹çš„__  
useRefçš„è¿”å›å€¼ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…æŒç»­å­˜åœ¨  
è€Œä¸åƒsetStateä¸€æ ·ï¼Œå…¶å€¼éœ€è¦åœ¨ä¸‹ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ‰å¾—åˆ°ä½“ç°ã€‚  
ä½†æ˜¯æ³¨æ„ï¼Œ å˜æ›´ .current å±æ€§ä¸ä¼šå¼•å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚



__useEffect ä¾èµ–ä¸ºç©ºæ•°ç»„ä¸ componentDidMount åŒºåˆ«__  
äºŒè€…éƒ½æ˜¯ä¼šåœ¨ç»„ä»¶åˆæ¬¡æ¸²æŸ“å®Œæˆåæ‰§è¡Œä¸€æ¬¡ã€‚  
ä¸¤è€…æœ€æ ¹æœ¬çš„åŒºåˆ«åœ¨äºï¼Œ  
componentDidMount çš„æ—¶æœºæ›´ä¸ºç²¾ç¡®ï¼Œä»–ç¡®ç¡®å®å®æ˜¯åœ¨ç»„ä»¶åˆ›å»ºå®ŒçœŸå®DOMå¹¶æŒ‚è½½å®Œæˆåç«‹å³è°ƒç”¨çš„ã€‚  
useEffect å®é™…ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªå®ä»»åŠ¡ï¼Œåœ¨ä¸‹ä¸ªäº‹ä»¶å¾ªç¯æ‰§è¡Œï¼Œè¿™ä¸ªæ—¶å€™ä¹Ÿå¿…ç„¶å·²ç»å®Œæˆäº†æ¸²æŸ“æµç¨‹ã€‚

__å‡½æ•°ç»„ä»¶çš„useStateå’Œç±»ç»„ä»¶çš„setStateæœ‰ä»€ä¹ˆåŒºåˆ«__  
ç±»ç»„ä»¶çš„setStateï¼Œä¿®æ”¹çš„æ•°æ®å‚¨å­˜åœ¨å…¶å®ä¾‹ä¸­ï¼ŒuseStateå‚¨å­˜åœ¨å½“å‰å‡½æ•°ç»„ä»¶å¯¹åº”çš„fiberä¸­ã€‚  
ç±»ç»„ä»¶çš„setStateï¼Œæ˜¯çœŸæ­£çš„ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼ŒuseStateä¸æ˜¯ã€‚




__1. ä¸ºä»€ä¹ˆ React å’Œ Vue3 éƒ½é€‰æ‹©äº†hooksï¼Œå®ƒå¸¦æ¥äº†é‚£äº›ä¾¿åˆ©ï¼Ÿ__  
[æµ…è°ˆ: ä¸ºå•¥vueå’Œreactéƒ½é€‰æ‹©äº†HooksğŸ‚ï¼Ÿ](https://juejin.cn/post/7066951709678895141)

[åœ¨ Vue3 ä¸­å®ç° React åŸç”Ÿ Hooksï¼ˆuseStateã€useEffectï¼‰è¿›è€Œæ·±å…¥ç†è§£ React Hooks çš„æœ¬è´¨åŸç†](https://juejin.cn/post/7121363865840910372)

[å¤§å‚é¢è¯•é¢˜æ¯æ—¥ä¸€é¢˜](https://q.shanyue.tech/fe/react/14.html)

[Hooks å¯¹äº Vue æ„å‘³ç€ä»€ä¹ˆï¼Ÿ](https://juejin.cn/post/7062259204941152293)

[React Hooks: ç»™Reactå¸¦æ¥äº†ä»€ä¹ˆå˜åŒ–ï¼Ÿ](https://juejin.cn/post/6844904149453111304)

__ä¸ºä»€ä¹ˆä¼ å…¥äºŒæ¬¡ç›¸åŒçš„çŠ¶æ€ï¼Œå‡½æ•°ç»„ä»¶ä¸æ›´æ–°__  
æ•°æ®å’Œè™šæ‹Ÿdomæ˜¯æ›´æ–°äº†çš„ï¼ŒUIæ²¡æ›´æ–°ï¼ŒDOMå¤ç”¨äº†æ—§DOMã€‚  
æ•°æ®éƒ½æ²¡æ›´æ–°åªå¯èƒ½æ˜¯ä½¿ç”¨äº†PureComponent

__hookså’Œç”Ÿå‘½å‘¨æœŸçš„å¼‚åŒ__  
ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œæ˜¯åœ¨æ³¨å†Œä¹‹åï¼Œåœ¨ç»„ä»¶è¿è¡Œçš„ç‰¹å®šæ—¶é—´è¿›è¡Œè°ƒç”¨ã€‚  
å‡½æ•°ç»„ä»¶çš„hooksï¼Œåœ¨å‡½æ•°æ¯æ¬¡æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šè¢«è°ƒç”¨ã€‚

__è‡ªå®šä¹‰Hook__  
è‡ªå®šä¹‰Hookå¿…é¡»ä»¥useå¼€å¤´ï¼Œå†…éƒ¨å¯ä»¥è°ƒç”¨å…¶ä»–hooksï¼Œç”¨äºæŠ½ç¦»å…¬å…±é€»è¾‘  
hooksçš„ç‰¹æ€§æ›´åƒæ˜¯ç»„ä»¶ï¼Œä¸¤ä¸ªç»„ä»¶è°ƒç”¨åŒä¸€ä¸ªhooksï¼Œstateä¸ä¼šå…±äº«ã€‚


__6. HOC å’Œ hook çš„åŒºåˆ«ï¼Ÿ__  
[ã€Reactæ·±å…¥ã€‘ä»Mixinåˆ°HOCå†åˆ°Hook](https://juejin.cn/post/6844903815762673671)


## refåŸç†

refçš„æœ¬è´¨å°±æ˜¯åˆ›å»ºä¸€ä¸ª `{current:null}` å¯¹è±¡ï¼Œå¹¶å°†refå¯¹è±¡ä¼ é€’ç»™å­ç»„ä»¶

å­ç»„ä»¶åœ¨ åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œ çœŸå®dom åˆ›å»ºå®Œæˆåï¼Œèµ‹å€¼ç»™ ref.current

è¿™æ ·ï¼Œåœ¨åˆå§‹åŒ–å®Œæˆåï¼Œå¤–éƒ¨å³å¯é€šè¿‡ref.currentè·å–åˆ°ï¼ŒçœŸå®dom

## contextåŸç†

1. providerå’Œconsumer çš„contextå±æ€§ æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡

2. provider consumer æœ¬è´¨æ˜¯æ¸²æŸ“å…¶ å­vdomï¼Œå°±åƒå‡½æ•°ç»„ä»¶ï¼Œç±»ç»„ä»¶ä¸€æ ·ï¼Œåªä¸è¿‡ä¼šç»™å­ä»£æ·»åŠ ä¸€äº›å±æ€§ã€‚

3. çˆ¶Providerå¾€å…±æœ‰å¯¹è±¡ä¸Šå­˜å€¼ï¼Œåœ¨å…¶åˆå§‹åŒ–å®Œæˆåï¼Œå­ä»£å¼€å§‹åˆå§‹åŒ–ï¼Œæ­¤æ—¶å­ä»£consumerå°±å¯ä»¥ä»è¿™ä¸ªå¯¹è±¡é‡Œæ‹¿å€¼å¹¶ä½¿ç”¨

> æœ¬è´¨ï¼ŒcreateContext() è¿”å›ä¸€ä¸ªcontextï¼Œå…·æœ‰ä¸¤ä¸ªå±æ€§ï¼Œproviderå’Œconsumerï¼Œ  
> è¿™ä¸¤ä¸ªå±æ€§å¯¹è±¡å…·æœ‰ _contextå±æ€§ï¼ŒåˆæŒ‡å‘context  
> ä¹‹åæ‰€æœ‰ç»™provideræŒ‚è½½çš„å±æ€§ï¼Œéƒ½ä¼šæŒ‚è½½è¿›provider._contextå¯¹è±¡ä¸­ï¼Œä¾›å­ä»£consumerä½¿ç”¨ã€‚

## äº‹ä»¶æœºåˆ¶

### åˆæˆäº‹ä»¶

__Reactåˆæˆäº‹ä»¶__ SyntheticEventï¼ŒDOMåŸç”Ÿäº‹ä»¶å†æ¬¡å°è£…ï¼ŒåŠ ä¸Šäº†ä¸€äº›è‡ªå®šä¹‰çš„å±æ€§å’Œå‡½æ•°,  
stopPropagationé˜»æ­¢Reactäº‹ä»¶å†’æ³¡ï¼Œ  
preventDefault é˜»æ­¢æµè§ˆå™¨é»˜è®¤è¡Œä¸ºï¼Œ  
nativeEventä»£è¡¨åŸç”ŸDOM

åˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶ï¼Œå°†DOMäº‹ä»¶åœ¨å…¶çˆ¶èŠ‚ç‚¹å¤„æ³¨å†Œçš„æœºåˆ¶ã€‚

å¤šä¸ªäº‹ä»¶åªç»‘å®šä¸€æ¬¡ï¼Œå‡å°‘äº‹ä»¶ç»‘å®šï¼Œå‡å°‘DOMäº¤äº’æ¬¡æ•°

æŠ¹å¹³å¹³å°å·®å¼‚ï¼Œæµè§ˆå™¨å…¼å®¹ï¼ŒReactNativeä¹Ÿå¯ä½¿ç”¨

åˆ‡ç‰‡ç¼–ç¨‹ï¼Œç»Ÿä¸€è¿›è¡Œäº‹ä»¶å¤„ç†ï¼Œ

æ‰¹é‡æ›´æ–°ï¼Œäº¤äº’è§¦å‘å¤šä¸ªäº‹ä»¶çŠ¶æ€å˜åŒ–ï¼Œå¯è¿›è¡Œä¸€æ¬¡æ›´æ–°ã€‚

äº‹ä»¶æ± æœºåˆ¶ï¼Œé¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯SyntheticEventå¯¹è±¡ï¼Œé‡Šæ”¾è¿‡ç¨‹å°†SyntheticEventå¯¹è±¡çš„å¤§éƒ¨åˆ†å±æ€§ç½®ä¸ºnullï¼Œæå‡æ—§æµè§ˆå™¨çš„æ€§èƒ½ã€‚

### äº‹ä»¶ä»£ç†

äº‹ä»¶ç»‘å®šæ—¶

1. äº‹ä»¶ç›‘å¬ ç»‘å®šåœ¨ å®¹å™¨rootä¸Šï¼Œ
2. äº‹ä»¶å¤„ç†å‡½æ•° ä»¥ é”®å€¼å¯¹çš„å½¢å¼å‚¨å­˜åœ¨ DOM.storeä¸­ï¼Œkeyä¸ºäº‹ä»¶ç±»å‹ valueä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ã€‚

äº‹ä»¶è§¦å‘æ—¶

1. äº‹ä»¶å†’æ³¡ï¼Œè§¦å‘ å®¹å™¨root çš„äº‹ä»¶ç›‘å¬ï¼Œå®¹å™¨root è°ƒç”¨å…¶ ç»Ÿä¸€äº‹ä»¶å¤„ç†å‡½æ•° dispatchEventï¼Œ
2. dispatchEvent é€šè¿‡event.target æ‹¿åˆ°å¯¹åº”DOMï¼Œ event.type æ‹¿åˆ°äº‹ä»¶ç±»å‹
3. é€šè¿‡ DOM.store[event.type] è°ƒç”¨ çœŸæ­£çš„ç›¸åº” äº‹ä»¶å¤„ç†å‡½æ•°handler(å¹¶ä¼ å…¥ åˆæˆäº‹ä»¶ )
4. handlerå†…çš„setStateå°†æ•°æ®å­˜å…¥æ›´æ–°é˜Ÿåˆ—ï¼Œæœ€å dispatchEvent æ‰¹é‡æ›´æ–°ã€‚

> è¿™ç§åšæ³•å«åˆ‡ç‰‡ç¼–ç¨‹ï¼Œreactå¯ä»¥åœ¨äº‹ä»¶å¤„ç†æ—¶åšä¸€äº›ç»Ÿä¸€çš„äº‹æƒ…ï¼Œæ¯”å¦‚ å¤„ç†æµè§ˆå™¨å…¼å®¹æ€§

### æ‰¹é‡æ›´æ–°

ä¸€æ¬¡æµè§ˆå™¨äº‹ä»¶è§¦å‘å¤šä¸ªç›‘å¬handlerï¼Œä¸€ä¸ªç›‘å¬handlerè°ƒç”¨å¤šä¸ªsetStateï¼Œå¤šæ¬¡å±æ€§ä¿®æ”¹ï¼Œåˆå¹¶ä¸ºä¸€æ¬¡vdomæ›´æ–°ï¼Œå’Œæ¸²æŸ“æ›´æ–°ã€‚

1. ç»Ÿä¸€äº‹ä»¶å¤„ç†å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå°†æ ‡è®° isBatchingUpdate ç½®ä¸ºtrueï¼Œéšå å¾ªç¯è°ƒç”¨ äº‹ä»¶è§¦å‘çš„æ‰€æœ‰handler

2. å½“æ ‡è®°ä¸ºtrueæ—¶ï¼Œæ‰€æœ‰ handler å†… setState çš„å±æ€§æ›´æ–°éƒ½ä¼šå‚¨å­˜åœ¨æ›´æ–°é˜Ÿåˆ—ä¸­ã€‚

3. ç­‰ æ‰€æœ‰ handleræ‰§è¡Œå®Œæ¯•ï¼Œå† æ›´æ–°æ‰€æœ‰vdomï¼Œå¹¶å°† æ ‡è®° isBatchingUpdate ç½®ä¸ºfalseï¼Œå† diffåˆ›å»ºçœŸå®DOMã€‚

> æ ‡è®°ä¸ºfalseæ—¶ï¼ŒsetState çš„å±æ€§æ›´æ–° ä¼šç›´æ¥æ›´æ–°vdomï¼Œdiffåˆ›å»ºçœŸå®DOMã€‚  
> å…¶å®å¹¶æ²¡æœ‰å¼‚æ­¥,è¿˜åœ¨å½“æ¬¡åŒæ­¥ä»»åŠ¡å†…,åªä¸è¿‡æ•°æ®æ›´æ–°åœ¨æ‰€æœ‰handleræ‰§è¡Œå®Œä¹‹å  
> è¿™ä¹ˆåšä½¿å¾—Reactæ— æ³•æ§åˆ¶çš„å¼‚æ­¥setStateå˜ä¸ºäº†æ›´å®‰å…¨çš„ç«‹å³æ›´æ–°ï¼Œè€ŒReactæ§åˆ¶èŒƒå›´å†…çš„setStateä¸ºæ‰¹é‡æ›´æ–°ã€‚

### React 17ä»¥å äº‹ä»¶æœºåˆ¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

1. ä»¥å‰å§”æ‰˜åˆ°documentï¼Œ17äº‹ä»¶å§”æ‰˜åˆ°root
ä¸ºäº†å…è®¸åŒæ—¶è¿è¡Œå¤šä¸ªç‰ˆæœ¬React

2. Reactäº‹ä»¶å¤„ç†æ•è·å’Œå†’æ³¡ï¼š
React17ä»¥å‰ï¼Œæ˜¯æ•è·åˆ°å†’æ³¡ï¼Œå†è‡ªå·±æ¨¡æ‹Ÿä¸€éæ•è·å’Œå†’æ³¡ï¼Œä¸€ä¸ªä¸ªå»è§¦å‘æ•è·äº‹ä»¶å’Œå†’æ³¡äº‹ä»¶ï¼Œä¸åŸç”Ÿäº‹ä»¶é¡ºåºä¸å…¼å®¹ã€‚  
React17ä»¥åï¼Œæ˜¯æ¯ä¸ªäº‹ä»¶æ³¨å†Œä¸¤é“ï¼Œä¸€é“æ•è·ï¼Œä¸€é“å†’æ³¡ï¼Œæ•è·è§¦å‘çš„æ—¶å€™ä¸€ä¸ªä¸ªå»è§¦å‘æ•è·äº‹ä»¶ï¼Œå†’æ³¡è§¦å‘çš„æ—¶å€™ä¸€ä¸ªä¸ªå»è§¦å‘å†’æ³¡äº‹ä»¶ã€‚  
React captureé˜¶æ®µçš„åˆæˆäº‹ä»¶æå‰åˆ°åŸç”Ÿäº‹ä»¶captureé˜¶æ®µæ‰§è¡Œ

3. ç§»é™¤äº‹ä»¶æ± æœºåˆ¶ï¼›

4. äº‹ä»¶æœ‰ä¼˜å…ˆçº§ã€‚ è¿ç»­äº‹ä»¶ > ç”¨æˆ·é˜»å¡äº‹ä»¶ > ç¦»æ•£äº‹ä»¶

__React ä¸­ onChange çš„åŸç”Ÿäº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ__

__inputç»„ä»¶ä¸­ï¼ŒonChangeå¤±å»ç„¦ç‚¹æ—¶è§¦å‘ï¼ŒonInputè¾“å…¥æ—¶è§¦å‘__



## ç»„ä»¶é€šä¿¡
[å…«è‚¡æ–‡](https://juejin.cn/post/7016593221815910408#heading-71)

## Laneä¼˜å…ˆçº§

[react - å…³äº react ä¸ºä»€ä¹ˆè¦ä» ExpirationTime åˆ‡æ¢åˆ° lane çš„ä¸€æ¬¡è€ƒå¤](https://juejin.cn/post/7095307142046941191)  
é¡ºä¾¿çœ‹çœ‹è¿™ä¸ªå¤§ä½¬çš„å…¶ä»–æ–‡ç« 

## ç±»ç»„ä»¶ å’Œ å‡½æ•°ç»„ä»¶ å¯¹æ¯”

ç±»ç»„ä»¶é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå‡½æ•°ç»„ä»¶å‡½æ•°å¼æ€æƒ³  
éƒ½å¯ä»¥æ¥æ”¶å±æ€§å¹¶è¿”å›ReactElement

__å‡½æ•°ç»„ä»¶æ›´åŠ å¥‘åˆ React æ¡†æ¶çš„è®¾è®¡ç†å¿µ__  
React ç»„ä»¶çš„ä¸»è¦å·¥ä½œ å°±æ˜¯ ä¸€ä¸ªåƒè¿›æ•°æ®ã€åå‡º UI çš„å‡½æ•°ã€‚  
React æ¡†æ¶çš„ä¸»è¦å·¥ä½œ å°±æ˜¯ æŠŠå£°æ˜å¼çš„ä»£ç è½¬æ¢ä¸ºå‘½ä»¤å¼çš„ DOM æ“ä½œã€‚

__å‡½æ•°ç»„ä»¶çš„ä¼˜ç‚¹__  
è¯­æ³•ç®€å•  
æ˜“äºæµ‹è¯•  
Hooks æä¾›äº†æ›´ç»†ç²’åº¦çš„é€»è¾‘ç»„ç»‡ä¸å¤ç”¨  
æ›´å¥½åœ°é€‚ç”¨äºæ—¶é—´åˆ‡ç‰‡ä¸å¹¶å‘æ¨¡å¼

__ç±»ç»„ä»¶çš„ç¼ºç‚¹__  
this çš„æ¨¡ç³Šæ€§  
ä¸šåŠ¡é€»è¾‘æ•£è½åœ¨ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œç”Ÿå‘½å‘¨æœŸåœ¨ç»§æ‰¿æ—¶ä¸å¯è§  
ç±»ç»„ä»¶å¯ä»¥é€šè¿‡ç»§æ‰¿å®ç°é€»è¾‘å¤ç”¨ï¼Œä½†æ˜¯ç»§æ‰¿çš„çµæ´»æ€§å·®ï¼Œç»†èŠ‚å±è”½å¤šï¼Œä¸æ¨èä½¿ç”¨  
ç±»ç»„ä»¶éœ€è¦åˆ›å»ºå¹¶ä¿å­˜å®ä¾‹ï¼Œä¼šå ç”¨ä¸€å®šå†…å­˜


## æ€§èƒ½ä¼˜åŒ–
React.PureComponent,React.memo,å½“å±æ€§ä¸å˜æ—¶ï¼Œä¸é‡æ–°æ¸²æŸ“ï¼Œè·³è¿‡æ›´æ–°é€»è¾‘  
memoåœ¨æ¸²æŸ“çš„æ—¶å€™å’Œå‡½æ•°ç»„ä»¶ä¸€æ ·ï¼Œæ‹¿åˆ°vdomç„¶åæ¸²æŸ“ï¼Œ  
ä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ä¼ å…¥çš„compareå‡½æ•°æ‰§è¡Œï¼Œè¿›è¡Œpropså¯¹æ¯”ï¼Œå¦‚æœä¸åŒï¼Œæ‰ä¼šæ›´æ–°ï¼Œå¦‚æœç›¸åŒï¼Œåˆ™ä¼šå¤ç”¨æ—§è™šæ‹Ÿdom

æœ€å¤–å±‚åŠ ä¸Šï¼Œå†…å±‚ä¹Ÿä¼šç›¸å½“äºPureComponentï¼Œå› ä¸ºçˆ¶ç»„ä»¶ä¸æ›´æ–°å­ç»„ä»¶ä¹Ÿä¸ä¼šæ›´æ–°

ä½¿ç”¨ React.memo æ¥ç¼“å­˜ç»„ä»¶ã€‚  
ä½¿ç”¨ React.useMemo ç¼“å­˜å¤§é‡çš„è®¡ç®—ã€‚  
é¿å…ä½¿ç”¨åŒ¿åå‡½æ•°ã€‚  
åˆ©ç”¨ React.lazy å’Œ React.Suspense å»¶è¿ŸåŠ è½½ä¸æ˜¯ç«‹å³éœ€è¦çš„ç»„ä»¶ã€‚  
å°½é‡ä½¿ç”¨ CSS è€Œä¸æ˜¯å¼ºåˆ¶åŠ è½½å’Œå¸è½½ç»„ä»¶ã€‚  
ä½¿ç”¨ React.Fragment é¿å…æ·»åŠ é¢å¤–çš„ DOMã€‚

[Reactæ€§èƒ½ä¼˜åŒ–çš„8ç§æ–¹å¼äº†è§£ä¸€ä¸‹ï¼Ÿ](https://juejin.cn/post/6844903924302888973)

1. åœ¨ React ä¸­å¦‚ä½•åšå¥½æ€§èƒ½ä¼˜åŒ– ?
ä»£ç åˆ†å‰² [åœ¨ React ä¸­å¦‚ä½•å®ç°ä»£ç åˆ†å‰²](https://zh-hans.reactjs.org/docs/code-splitting.html)

åœ¨React16.6å¼•å…¥äº†Suspenseå’ŒReact.lazyï¼Œç”¨æ¥åˆ†å‰²ç»„ä»¶ä»£ç ã€‚


## React

__è¯·è¯´ä¸€ä¸‹ä½ å¯¹ React çš„ç†è§£?__  
[ç å³°](http://zhufengpeixun.com/strong/html/126.11.react-1.html)

__è¯·è¯´ä¸€ä¸‹Reactä¸­çš„æ¸²æŸ“æµç¨‹__  
[ç å³°](http://zhufengpeixun.com/strong/html/126.11.react-1.html#t485.%20%E8%AF%B7%E8%AF%B4%E4%B8%80%E4%B8%8B%20React%20%E4%B8%AD%E7%9A%84%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B)

__å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶__  
Reactæ²¡æœ‰åŒå‘ç»‘å®š

å—æ§ç»„ä»¶: ä½¿ç”¨stateæ§åˆ¶è¡¨å•å…ƒç´ çš„valueï¼Œä½¿ç”¨onChange ä¸ setStateæ›´æ–°stateï¼Œä»è€Œæ›´æ–°è§†å›¾ï¼Œæ§åˆ¶ç”¨æˆ·è¾“å…¥è¿‡ç¨‹è¡¨å•çš„æ“ä½œã€‚

éå—æ§ç»„ä»¶: é€šè¿‡ä½¿ç”¨Refå±æ€§æ‹¿åˆ°DOMï¼Œå†é€šè¿‡.valueæ‹¿åˆ°æ•°æ®ã€‚

ç»å¤§éƒ¨åˆ†æ—¶å€™æ¨èä½¿ç”¨å—æ§ç»„ä»¶æ¥å®ç°è¡¨å•ï¼Œå› ä¸ºåœ¨å—æ§ç»„ä»¶ä¸­ï¼Œè¡¨å•æ•°æ®ç”±Reactç»„ä»¶è´Ÿè´£å¤„ç†

å½“ç„¶å¦‚æœé€‰æ‹©éå—æ§ç»„ä»¶çš„è¯ï¼Œè¡¨å•æ•°æ®ç›¸å½“äºç”±DOMè‡ªå·±å¤„ç†ã€‚

fileç±»å‹çš„è¡¨å•æ§ä»¶åªèƒ½ç”±ç”¨æˆ·è®¾ç½®å€¼ï¼Œä½œä¸ºéå—æ§ç»„ä»¶

[å—æ§ç»„ä»¶ä¸éå—æ§ç»„ä»¶](https://juejin.cn/post/6858276396968951822#heading-2)

__React ç»„ä»¶æ˜¯æ€ä¹ˆæ¸²æŸ“ä¸º DOM å…ƒç´ åˆ°é¡µé¢ä¸Šçš„__  
__React ä¸­ setState è°ƒç”¨ä»¥åä¼šç»å†å“ªäº›æµç¨‹__  
__å¦‚ä½•è¿›è¡Œæ•°æ®ç®¡ç†__  
__ä½ æåˆ°äº† React Contextï¼Œè¯´ä¸€ä¸‹å®ƒçš„åŸç†__  
__èƒ½è¯´ä¸€ä¸‹ Redux çš„åŸç†å—__  
__useState æ˜¯æ€ä¹ˆå®ç°çš„__  
__é€šè¿‡ä¸‹æ ‡æŒ‡å®š key çš„è¯ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ__

__React ä¸­ fiber æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„__  
[React ä¸­ fiber æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„](https://q.shanyue.tech/fe/react/165.html)  
Fiberå‡ºç°åœ¨React16ç‰ˆæœ¬ï¼Œåœ¨15åŠä»¥å‰çš„ç‰ˆæœ¬ï¼ŒReactæ›´æ–°DOMéƒ½æ˜¯ä½¿ç”¨é€’å½’çš„æ–¹å¼è¿›è¡Œéå†ï¼Œæ¯æ¬¡æ›´æ–°éƒ½ä¼šä»åº”ç”¨æ ¹éƒ¨é€’å½’æ‰§è¡Œï¼Œä¸”ä¸€æ—¦å¼€å§‹ï¼Œæ— æ³•ä¸­æ–­ï¼Œè¿™æ ·å±‚çº§è¶Šæ¥è¶Šæ·±ï¼Œç»“æ„å¤æ‚åº¦é«˜çš„é¡¹ç›®å°±ä¼šå‡ºç°æ˜æ˜¾çš„å¡é¡¿ã€‚fiberæ¶æ„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œfiberæ˜¯åœ¨Reactä¸­æœ€å°ç²’åº¦çš„æ‰§è¡Œå•å…ƒï¼Œå¯ä»¥å°†fiberç†è§£ä¸ºæ˜¯Reactçš„è™šæ‹ŸDOMã€‚åœ¨Reactä¸­ï¼Œæ›´æ–°fiberçš„è¿‡ç¨‹å«åšè°ƒå’Œï¼Œæ¯ä¸€ä¸ªfiberéƒ½å¯ä»¥ä½œä¸ºä¸€ä¸ªæ‰§è¡Œå•å…ƒè¿›è¡Œå¤„ç†ï¼ŒåŒæ—¶æ¯ä¸ªfiberéƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§laneï¼ˆ16ç‰ˆæœ¬æ˜¯expirationTimeï¼‰æ¥åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ç©ºé—´æˆ–æ—¶é—´æ¥æ‰§è¡Œæ›´æ–°ï¼Œå¦‚æœæ²¡æœ‰æ—¶é—´æ›´æ–°ï¼Œå°±ä¼šæŠŠä¸»åŠ¨æƒäº¤ç»™æµè§ˆå™¨å»åšä¸€äº›æ¸²æŸ“ï¼ˆå¦‚åŠ¨ç”»ã€é‡æ’ã€é‡ç»˜ç­‰ï¼‰ï¼Œç”¨æˆ·å°±ä¸ä¼šæ„Ÿè§‰åˆ°å¡é¡¿ã€‚ç„¶åï¼Œå½“æµè§ˆå™¨ç©ºé—²äº†ï¼ˆrequestIdleCallbackï¼‰ï¼Œå°±é€šè¿‡schedulerï¼ˆè°ƒåº¦å™¨ï¼‰å°†æ‰§è¡Œæ¢å¤åˆ°æ‰§è¡Œå•å…ƒä¸Šï¼Œè¿™æ ·æœ¬è´¨ä¸Šæ˜¯ä¸­æ–­äº†æ¸²æŸ“ï¼Œä¸è¿‡é¢˜æ”¹äº†ç”¨æˆ·çš„ä½“éªŒã€‚Reactå®ç°çš„fiberæ¨¡å¼æ˜¯ä¸€ä¸ªå…·æœ‰é“¾è¡¨å’ŒæŒ‡é’ˆçš„å¼‚æ­¥æ¨¡å‹ã€‚  
fiberä½œä¸ºreactåˆ›å»ºçš„elementå’ŒçœŸå®DOMä¹‹é—´çš„æ¡¥æ¢ï¼Œæ¯ä¸€æ¬¡æ›´æ–°çš„è§¦å‘ä¼šåœ¨React elementå‘èµ·ï¼Œç»è¿‡fiberçš„è°ƒå’Œï¼Œç„¶åæ›´æ–°åˆ°çœŸå®DOMä¸Šã€‚fiberä¸Šæ ‡è¯†äº†å„ç§ä¸åŒç±»å‹çš„elementï¼ŒåŒæ—¶è®°å½•äº†å¯¹åº”å’Œå½“å‰fiberæœ‰å…³çš„å…¶ä»–fiberä¿¡æ¯ï¼ˆreturnæŒ‡å‘çˆ¶çº§ã€childæŒ‡å‘å­çº§ã€siblingæŒ‡å‘å…„å¼Ÿï¼‰ã€‚  
åœ¨Reactåº”ç”¨ä¸­ï¼Œåº”ç”¨é¦–æ¬¡æ„å»ºæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªfiberRootä½œä¸ºæ•´ä¸ªReactåº”ç”¨çš„æ ¹åŸºã€‚ç„¶åå½“ReactDOM.renderæ¸²æŸ“å‡ºæ¥æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªrootFiberå¯¹è±¡ï¼ˆä¸€ä¸ªRactåº”ç”¨å¯ä»¥ç”¨å¤šä¸ªrootFiberï¼Œä½†åªèƒ½æœ‰ä¸€ä¸ªfiberRootï¼‰ï¼Œå½“ä¸€æ¬¡æŒ‚è½½å®Œæˆæ—¶ï¼ŒfiberRootçš„currentå±æ€§ä¼šæŒ‡å‘å¯¹åº”rootFiberã€‚æŒ‚è½½å®Œæˆåï¼Œä¼šè¿›å…¥æ­£å¼æ¸²æŸ“é˜¶æ®µï¼Œåœ¨è¿™ä¸ªé˜¶æ®µå¿…é¡»çŸ¥é“ä¸€ä¸ªworkInProgerssæ ‘ï¼ˆå®ƒæ˜¯æ­£åœ¨å†…å­˜åœ¨æ„å»ºçš„Fiberæ ‘ï¼Œåœ¨ä¸€æ¬¡æ›´æ–°ä¸­ï¼Œæ‰€æœ‰çš„æ›´æ–°éƒ½å‘ç”Ÿåœ¨workInProgeressæ ‘ä¸Šï¼Œæ›´æ–°å®Œæˆåï¼Œå°†å˜æˆcurrentæ ‘ç”¨äºæ¸²æŸ“è§†å›¾ï¼‰,å½“å‰çš„currentæ ‘ï¼ˆrootFiberï¼‰çš„alternateä¼šä½œä¸ºworkInProgerssï¼ŒåŒæ—¶ä¼šç”¨alternateå°†workInProgressä¸currentæ ‘è¿›è¡Œå…³è”ï¼ˆè¯¥å…³è”åªæœ‰åœ¨åˆå§‹åŒ–ç¬¬ä¸€æ¬¡åˆ›å»ºalternateæ—¶è¿›è¡Œï¼‰ã€‚


## React æ¶‰åŠçš„ç®—æ³•
__LRUç®—æ³•__  
åœ¨React16.6å¼•å…¥äº†Suspenseå’ŒReact.lazyï¼Œç”¨æ¥åˆ†å‰²ç»„ä»¶ä»£ç ã€‚

## React-router
[React/Vue ä¸­çš„ router å®ç°åŸç†å¦‚ä½•](https://q.shanyue.tech/fe/react/463.html#history-api)


## React18
[React18 æ–°ç‰¹æ€§è§£è¯»](https://juejin.cn/post/7094037148088664078)

| ç‰¹æ€§     | æ—§æ¨¡å‹ (React16)  | æ–°æ¨¡å‹ (React18)     |
| ------ | -------------- | ----------------- |
| ä¼˜å…ˆçº§ç²’åº¦  | ç²— (ä»… 5 ä¸ªç­‰çº§)    | ç»†åˆ°æ¯ç±»ä»»åŠ¡            |
| å¤šä»»åŠ¡å…±å­˜  | âŒ å•ä»»åŠ¡å¯ä¸­æ–­       | âœ… å¤šä»»åŠ¡å¹¶è¡Œ           |
| æ‰¹å¤„ç†ç­–ç•¥  | æ‰‹åŠ¨ & äº‹ä»¶å†…       | è‡ªåŠ¨ï¼ˆAuto Batchingï¼‰ |
| å¯æ¢å¤æ€§   | å±€éƒ¨æ¢å¤           | ç²¾ç¡®æ¢å¤ç‰¹å®š lane       |
| æ ¸å¿ƒè°ƒåº¦ä¾æ® | æ—¶é—´ç‰‡ (deadline) | ä¼˜å…ˆçº§é€šé“ (lanes)     |





## ç”Ÿå‘½å‘¨æœŸ

æŒ‚è½½  
constructor  
componentWillMount  
render  
componentDidMount

æ›´æ–°  
componentWillReceiveProps  
shouldComponentUpdate  
componentWillUpdate  
render  
componentDidUpdate

å¸è½½  
componentWillUnmount

React 16.3 å¼€å§‹  
ã€__getDerivedStateFromProps__ã€‘ä»propsè·å–æ´¾å‘çŠ¶æ€,staticå‡½æ•°,æ— æ³•ä½¿ç”¨this  
> è¢«æ•…æ„è®¾è®¡æˆ static å‡½æ•°,å› ä¸ºä»¥å‰åœ¨ componentWillReceivePropsä¸­ç”¨setStateä¼šæ­»å¾ªç¯,ç°åœ¨ä¸è®©ç”¨thisäº†

ã€__getSnapshotBeforeUpdate__ã€‘renderä¹‹åæ–°æ—§vdomå³å°†å¯¹æ¯”æ›¿æ¢æ—¶æ‰§è¡Œ  
ç”¨äºåœ¨ç»„ä»¶çœŸå®DOMæ›´æ–°ä¹‹å‰,æ‹¿åˆ°è€çœŸå®DOMçš„ä¸€äº›ä¿¡æ¯,è¿”å›å€¼ä¼šä¼ ç»™ componentDidUpdate

æŒ‚è½½  
constructor  
getDerivedStateFromProps  
render  
componentDidMount

æ›´æ–°  
getDerivedStateFromProps  
shouldComponentUpdate  
render  
getSnapshotBeforeUpdate  
componentDidUpdate

å¸è½½  
componentWillUnmount

__ç”Ÿå‘½å‘¨æœŸçš„çˆ¶å­ç»„ä»¶çš„æ‰§è¡Œé¡ºåºï¼Ÿ__  
çˆ¶å­ç»„ä»¶åˆå§‹åŒ–

çˆ¶ç»„ä»¶ constructor  
çˆ¶ç»„ä»¶ getDerivedStateFromProps  
çˆ¶ç»„ä»¶ render  
å­ç»„ä»¶ constructor  
å­ç»„ä»¶ getDerivedStateFromProps  
å­ç»„ä»¶ render  
å­ç»„ä»¶ componentDidMount  
çˆ¶ç»„ä»¶ componentDidMount

å­ç»„ä»¶ä¿®æ”¹è‡ªèº«state

å­ç»„ä»¶ getDerivedStateFromProps  
å­ç»„ä»¶ shouldComponentUpdate  
å­ç»„ä»¶ render  
å­ç»„ä»¶ getSnapShotBeforeUpdate  
å­ç»„ä»¶ componentDidUpdate

çˆ¶ç»„ä»¶ä¿®æ”¹props

çˆ¶ç»„ä»¶ getDerivedStateFromProps  
çˆ¶ç»„ä»¶ shouldComponentUpdate  
çˆ¶ç»„ä»¶ render  
å­ç»„ä»¶ getDerivedStateFromProps  
å­ç»„ä»¶ shouldComponentUpdate  
å­ç»„ä»¶ render  
å­ç»„ä»¶ getSnapShotBeforeUpdate  
çˆ¶ç»„ä»¶ getSnapShotBeforeUpdate  
å­ç»„ä»¶ componentDidUpdate  
çˆ¶ç»„ä»¶ componentDidUpdate

å¸è½½å­ç»„ä»¶

çˆ¶ç»„ä»¶ getDerivedStateFromProps  
çˆ¶ç»„ä»¶ shouldComponentUpdate  
çˆ¶ç»„ä»¶ render  
çˆ¶ç»„ä»¶ getSnapShotBeforeUpdate  
å­ç»„ä»¶ componentWillUnmount  
çˆ¶ç»„ä»¶ componentDidUpdate

__å‡½æ•°ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ__
